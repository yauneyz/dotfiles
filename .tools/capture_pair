#!/usr/bin/env bash
# capture_pair.sh
# Usage: ./capture_pair.sh <name> <variable>
# Example: ./capture_pair.sh Ship 001

set -euo pipefail

# --- CONFIG: set your fixed rectangles here ("X,Y WIDTHxHEIGHT" for grim) ---
# Note: maim used WIDTHxHEIGHT+X+Y, but grim uses "X,Y WIDTHxHEIGHT"
SCRAMBLE_GEOM="2650,889 646x712"   # e.g. Left 2650 Top 889 Width 646 Height 712
COMPLETE_GEOM="3294,897 624x704"    # change this to your second rectangle

# grim doesn't need a cursor flag (cursors are hidden by default on Wayland)
GRIM_CURSOR_FLAG=""

# --- OUTPUT LAYOUT ---
NAME="${1:-}"
VAR="${2:-}"

if [[ -z "${NAME}" || -z "${VAR}" ]]; then
  echo "Usage: $0 <name> <variable>"
  echo "Example: $0 Ship 001"
  exit 1
fi

# Output directory (per your project structure)
OUTDIR="${HOME}/development/Lando/lando-video/${NAME}"
mkdir -p "${OUTDIR}"

SCRAMBLE_OUT="${OUTDIR}/scramble-${NAME}-${VAR}.png"
COMPLETE_OUT="${OUTDIR}/complete-${NAME}-${VAR}.png"

# --- CHECKS ---
command -v grim >/dev/null 2>&1 || { echo "Error: grim not found. Install it first."; exit 1; }

# --- CAPTURE ---
echo "Capturing scramble -> ${SCRAMBLE_OUT}"
grim -g "${SCRAMBLE_GEOM}" "${SCRAMBLE_OUT}"

echo "Capturing complete  -> ${COMPLETE_OUT}"
grim -g "${COMPLETE_GEOM}" "${COMPLETE_OUT}"

echo "Done."
