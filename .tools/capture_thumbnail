#!/usr/bin/env bash
# capture_single.sh
# Usage: ./capture_single.sh <Name> <Variable>
# Example: ./capture_single.sh Ship 001
#
# Result:
#   ~/development/Lando/lando-video/Ship/Ship-001.png
#
# Edit GEOM below to the rectangle you want to capture.

set -euo pipefail

### --- CONFIG --- ###
# Fixed capture geometry for grim: "X,Y WIDTHxHEIGHT"
# (Note: maim used WIDTHxHEIGHT+X+Y, but grim uses "X,Y WIDTHxHEIGHT")
# Update this to your rectangle (use discover_geometry to get the correct format)
GEOM="1507,345 720x597"

# Hide cursor in screenshots. Set to "" if you want the cursor visible.
# grim doesn't have a cursor flag, but cursors are hidden by default on Wayland
GRIM_CURSOR_FLAG=""
### --- END CONFIG --- ###

# Inputs
NAME="${1:-}"
VAR="${2:-}"

if [[ -z "${NAME}" || -z "${VAR}" ]]; then
  echo "Usage: $0 <Name> <Variable>"
  echo "Example: $0 Ship 001"
  exit 1
fi

# Output directory and filename
OUTDIR="${HOME}/development/Lando/lando-video/${NAME}"
mkdir -p "${OUTDIR}"

OUTFILE="${OUTDIR}/${NAME}-${VAR}.png"

# Check dependencies
if ! command -v grim >/dev/null 2>&1; then
  echo "Error: grim not found. Install grim first."
  exit 1
fi

echo "Capturing region ${GEOM} -> ${OUTFILE}"
grim -g "${GEOM}" "${OUTFILE}"

echo "Done."
